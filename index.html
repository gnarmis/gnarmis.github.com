
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Kilotau</title>
  <meta name="author" content="Gursimran Singh">

  
  <meta name="description" content="Today, I cleaned up an earlier project I&#8217;d left hanging around called Colby. It&#8217;s a little
wrapper around the data structures that the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://gnarmis.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Kilotau" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-27751478-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <!-- <header role="banner"></header> -->
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:gnarmis.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/"><i><b>Kilotau</b></i></a></li>
  <li><a href="/blog/categories/projects">Projects</a></li> 
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/categories/">Categories</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/11/colby-small-wrapper-and-functions-for-persistent/">Colby: Small Wrapper and Functions for Persistent, Immutable Data Structures</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-11T17:52:00-06:00" pubdate data-updated="true">Jan 11<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today, I cleaned up an earlier project I&#8217;d left hanging around called <a href="http://github.com/gnarmis/colby">Colby</a>. It&#8217;s a little
wrapper around the data structures that the Hamster gem provides, and it adds some functions
to make working with those data structures a little similar to the Clojure-way.</p>

<p>At this point, Colby is very experimental and is only at a <code>0.0.1</code> release to reflect its
brittleness. However, all specs pass currently and it&#8217;s useable as-is. I&#8217;ve pushed the initial
release to RubyGems, so you can start using Colby by just doing <code>gem install colby</code>.</p>

<p>Comments welcome! I realize this may be a bit simple compared to <a href="http://github.com/rouge-lang/rouge">rouge</a>, which is an awesome
project, but I&#8217;ll keep this around for my own edification.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/05/project-euler-problem-3-using-clojure-1-dot-5-and-a-lazy-technique/">Project Euler Problem 3 Using Clojure 1.5 and a Lazy Technique</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-05T12:36:00-06:00" pubdate data-updated="true">Jan 5<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The problem: find the largest prime factor of 600851475143.</p>

<p>I used the Sieve of Eratosthenes and Ruby to solve it <a href="http://kilotau.com/blog/2011/06/28/primes-and-sieves/">last time</a>.</p>

<p>This time, I tried a lazy, functional approach. The result was an efficient,
straightfoward solution that involved no sieve or any static/full-realized
data structure at all! I make a recipe for the kind of numbers I want and
then take just as many as I need in order to finally output the answer.</p>

<p>Here&#8217;s my lazy, functional implementation using Clojure 1.5 RC1 (mostly because
I wanted to play with the new reducers library). It&#8217;s pretty efficient: less
than a quarter of a second on my 2011 13&#8221; base MBP!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">euler.three</span>
</span><span class='line'> <span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">clojure.core.reducers</span> <span class="ss">:as</span> <span class="nv">r</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">declare </span><span class="nv">largest-prime-factor-for</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="kd">declare </span><span class="nv">factors-of</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="kd">declare </span><span class="nv">source-factors</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="kd">declare </span><span class="nv">source-naturals</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="kd">declare </span><span class="nv">factor?</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="kd">declare </span><span class="nv">prime?</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="kd">declare </span><span class="nv">certainty</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">answer</span> <span class="p">[]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">time </span><span class="p">(</span><span class="nf">largest-prime-factor-for</span> <span class="mi">600851475143</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">largest-prime-factor-for</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">prime-factors</span> <span class="p">(</span><span class="nf">r/filter</span> <span class="nv">prime?</span>
</span><span class='line'>                                <span class="p">(</span><span class="nf">factors-of</span> <span class="nv">n</span><span class="p">))]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">last </span><span class="p">(</span><span class="nb">into </span><span class="p">[]</span> <span class="nv">prime-factors</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">factors-of</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">r/filter</span> <span class="o">#</span><span class="p">(</span><span class="nf">factor?</span> <span class="nv">n</span> <span class="nv">%</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">source-factors</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">source-factors</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">r/take-while</span> <span class="o">#</span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">%</span> <span class="p">(</span><span class="nb">int </span><span class="p">(</span><span class="nf">Math/sqrt</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">source-naturals</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">source-naturals</span> <span class="p">[]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">r/map</span> <span class="o">#</span><span class="p">(</span><span class="nb">+ </span><span class="nv">%</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">range</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">factor?</span> <span class="p">[</span><span class="nv">n</span> <span class="nv">possib</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">mod</span> <span class="nv">n</span> <span class="nv">possib</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">prime?</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">.isProbablePrime</span> <span class="p">(</span><span class="nf">BigInteger/valueOf</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">certainty</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">certainty</span> <span class="mi">10</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/18/repomap-track-your-local-git-repositories/">RepoMap: Track Your Local Git Repositories</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-18T16:09:00-06:00" pubdate data-updated="true">Dec 18<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Github link: <a href="http://github.com/gnarmis/repomap">RepoMap</a></p>

<p>There are hundreds of git repositories stored at various folder depths all over
my computer. Organizing them, remembering where they are or determining whether
I still have a working copy cloned from a remote repository is a chore.</p>

<p>So, why not have a map of where all my repositories are? Should be simple
enough to keep a YAML file with a map from paths to repository names.</p>

<p>After some hacking on a flight (after having finished finals and an interview),
I made a little Ruby CLI program and found it to be useful enough to expand into
a tiny little gem. It&#8217;s still very basic, and specs aren&#8217;t where they should be,
but the essentials are there.</p>

<p>It&#8217;s called RepoMap, and you can find it here:
<a href="http://github.com/gnarmis/repomap">http://github.com/gnarmis/repomap</a>.</p>

<p>You can also install it by typing <code>gem install repomap</code>.</p>

<p>Check out the above link for details about how it works. Pull requests are
welcome! I&#8217;m thinking there&#8217;s a number of cool additions possible, such as
mining all that useful meta data about git repositories, and making use of the
map in interesting ways.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/08/twitter-spam-machine-learning/">Ready Spam Detection in Twitter - Extended Abstract</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-08T19:03:00-06:00" pubdate data-updated="true">Dec 8<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Marcel Flores, Maciej Swiech and I have been working hard on our machine
learning project, in which we are asking whether we can detect twitter spammer
upon account creation, before they&#8217;ve made a single spammy tweet. Our results
have been promising and I&#8217;m posting here a link to the project website:
<a href="http://twspam.wordpress.com">Ready Spam Detection in Twitter</a>.</p>

<p>At the above link you&#8217;ll find our project details, approach, results, analysis,
and an accompanying extended abstract in ACM format.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/10/18/hack-northwestern-updates/">Hack Northwestern Updates</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-10-18T19:45:00-05:00" pubdate data-updated="true">Oct 18<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It&#8217;s been a busy few days at Hack Northwestern! We got a <a href="http://hacknorthwestern.com">new home</a>, announced a <a href="http://hacknorthwestern.com/imo-hackathon.html">hackathon</a> sponsored by <a href="http://imo.im">imo</a>, and just wrapped up a tech talk / hack night by folks from <a href="http://seelio.com">Seelio</a> yesterday!</p>

<p>It&#8217;s humbling to note that this started as an idle suggestion last spring, and then a quick get-together of around 7 students. Here&#8217;s an <a href="http://northbynorthwestern.com/story/30-collaborate-eat-pizza-at-hackathon/">article</a> about only the second such hack night, which exploded to around 30-40 people (even some from UChicago!). The idea behind this effort has stayed constant: fostering student creativity, entrepreneurship, and hacker spirit. It&#8217;s a testament to Northwestern&#8217;s active entrepreneur and hacker community that Hack Northwestern is seeing such quick validation of its efforts.</p>

<p>As we continue to build connections between different communities at Northwestern and the tech world at large, we find an undercurrent of excitement that is inspiring. And hearing about similar such efforts at various other universities is even more gratifying.</p>

<p>University is more than just a trade school, and Hack Northwestern hopes to prove that.</p>

<p>If this is the first you&#8217;ve heard of us, check out our <a href="http://hacknorthwestern.com">home</a>!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/26/rubys-method-missing-is-kinda-nice/">Ruby&#8217;s `method_missing` Is Cool / Hashes as Functions of Their Keys</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-26T11:59:00-05:00" pubdate data-updated="true">Sep 26<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I had an idea to try and bring a tiny bit of Clojure&#8217;s ideas of hash-maps to Ruby&#8217;s hashes. I came up with a simple monkey-patch that allows you to truly use hashes as functions of their keys. In the process, I&#8217;ve come to really dig <code>method_missing</code>, although debugging it can be a chore. Word of advice: always implement <code>respond_to?</code> with your <code>method_missing</code>. Principle of Least Surprise, people.</p>

<div><script src='https://gist.github.com/3789174.js?file=functional_hash.rb'></script>
<noscript><pre><code># In Clojure, hash-maps are truly functions of keys to values.
# So you can do `(:a {:a 1})` and get `1` as the result
# Why not put this in Ruby?

# access keys of a hash like a function

class Object
  def respond_to?(method)
    if (method.to_s =~ /^_.*/) == 0
      true
    else
      super
    end
  end
  def method_missing(name, *args, &amp;b)
    if (args.count==1) &amp;&amp; b.nil? &amp;&amp; name[0]==&quot;_&quot; &amp;&amp;
       args[0].has_key?(name[1..-1].to_sym)
      args[0][name[1..-1].to_sym]
    else
      super
    end
  end
end


hash = {:a =&gt; 1}
(_a hash) == 1 #=&gt; true
(_a hash) == (hash [:a]) #=&gt; true

# the underscore serves to prevent naming conflicts to a degree


</code></pre></noscript></div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/25/on-ruby-1-dot-9-s-flexible-syntax/">On Ruby 1.9&#8217;s Flexible Syntax</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-25T13:57:00-05:00" pubdate data-updated="true">Sep 25<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Over the past day or so, I&#8217;ve been playing around with small bits of Ruby after spending most of the summer in Clojure-land. There&#8217;s great similarities in both Ruby and Clojure (functional style, dynamic, etc), and both are very practical choices. Clojure gives you amazing access to JVM land while not forcing you to pull your hair out, and Ruby grants you a good selection of libraries and amazing tools for web development.</p>

<p>But here I want to highlight a few experiments I did to try and brighten up my Ruby-writing experience. The things here could be unneccessarily divergent, but what the hell. It made me realize you can bend Ruby in a lot of ways I hadn&#8217;t thought of before</p>

<h2>define methods on the fly</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">defn</span> <span class="nb">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span>
</span><span class='line'>  <span class="no">Object</span><span class="o">.</span><span class="n">send</span> <span class="ss">:define_method</span><span class="p">,</span> <span class="nb">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>:define_method</code> is an amazing little method that allows you define methods (on any object too, so you could define class/module methods). That&#8217;s all there is to it. Now you can do this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">defn</span><span class="p">(</span><span class="ss">:a</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="o">|</span> <span class="nb">print</span> <span class="n">x</span><span class="p">;</span> <span class="nb">print</span> <span class="n">y</span><span class="p">}</span>
</span><span class='line'><span class="c1"># and if you want to superficially lispy</span>
</span><span class='line'><span class="p">(</span><span class="n">defn</span> <span class="p">(</span><span class="ss">:a</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="o">|</span> <span class="nb">print</span> <span class="n">x</span><span class="p">;</span> <span class="nb">print</span> <span class="n">y</span><span class="p">})</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="n">a</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">#-&gt; 1[2,3,4]</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># for multiline methods, this seems easier:</span>
</span><span class='line'><span class="n">defn</span> <span class="p">(</span><span class="ss">:sum_of_squares</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">|</span>
</span><span class='line'>  <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This also works for associating any name with any kind of lambda.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">(</span><span class="n">defn</span> <span class="p">(</span><span class="ss">:foo</span><span class="p">)</span> <span class="p">{</span><span class="mi">23</span><span class="p">})</span>
</span><span class='line'><span class="n">foo</span> <span class="o">==</span> <span class="mi">23</span> <span class="c1">#=&gt; true</span>
</span></code></pre></td></tr></table></div></figure>


<h2>let / with</h2>

<p>In Lispy languages, there&#8217;s something like a function called <code>let</code> which lets you define some names in a new lexical scope and operate with them. An example in Clojure:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">x</span> <span class="mi">1</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span> <span class="c1">;-&gt; 1</span>
</span><span class='line'><span class="nv">x</span> <span class="c1">;-&gt; error, x is not defined outside the above form</span>
</span></code></pre></td></tr></table></div></figure>


<p>In Ruby, we have something kind of like that called <code>#tap</code>, which Zach Hobson covered <a href="http://www.opensourcery.com/blog/zack-hobson/objectlet-ruby-0">here</a>. He suggested a simple way to define <code>#let</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Object</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">let</span>
</span><span class='line'>    <span class="k">yield</span> <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Now you can do this:</span>
</span><span class='line'>
</span><span class='line'><span class="p">((</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">let</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">})</span> <span class="o">==</span> <span class="mi">3</span> <span class="c1">#=&gt; true</span>
</span></code></pre></td></tr></table></div></figure>


<p>But I think an even more beautiful way to do it is like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">with</span> <span class="n">coll</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span>
</span><span class='line'> <span class="n">coll</span><span class="o">.</span><span class="n">map</span> <span class="o">&amp;</span><span class="n">b</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">with</span> <span class="o">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">]]</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">}</span> <span class="c1">#=&gt; 3</span>
</span></code></pre></td></tr></table></div></figure>


<p>For more on destructuring and everything&#8217;s that&#8217;s possible there, check out <a href="http://po-ru.com/diary/destructuring-assignment-in-ruby/">this post</a>.</p>

<h2>map, reduce, filter, pipe, call, body</h2>

<p>There&#8217;s a lot more craziness to explore. I&#8217;ll let the code, comments, and examples from my <a href="https://gist.github.com/3760519">gist</a> explain. This is just bits of code here and there, honestly. <a href="http://twitter.com/gnarmis">Tweet at me</a> to discuss! Also, the <a href="https://gist.github.com/3760519">gist</a> will be the most up-to-date version of this.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># execute an array of lambdas one after another?</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">body</span> <span class="o">*</span><span class="n">args</span>
</span><span class='line'>  <span class="n">args</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">e</span><span class="o">|</span> <span class="n">e</span><span class="o">.</span><span class="n">call</span><span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="n">body</span> <span class="p">(</span><span class="nb">lambda</span> <span class="p">{</span><span class="nb">print</span> <span class="mi">1</span><span class="p">}),</span> <span class="p">(</span><span class="nb">lambda</span> <span class="p">{</span><span class="nb">print</span> <span class="mi">2</span><span class="p">}))</span> <span class="c1">#=&gt; output: 12</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># map as a &quot;top-level&quot; function. This maps some lambda to an array, </span>
</span><span class='line'><span class="c1"># passing each element to the lambda to call.</span>
</span><span class='line'><span class="c1"># (also, who doesn&#39;t like stabby lambdas?)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">map</span> <span class="n">fun</span><span class="p">,</span> <span class="n">coll</span>
</span><span class='line'>  <span class="n">coll</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">fun</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">i</span><span class="p">)}</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="n">map</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">},</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">)</span> <span class="c1">#=&gt; [2, 3, 4]</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># reduce as a &quot;top-level&quot; function</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">reduce</span> <span class="n">fun</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="kp">nil</span><span class="p">,</span> <span class="n">coll</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">coll</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">to_sym</span><span class="p">)</span> <span class="k">unless</span> <span class="n">val</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">coll</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span> <span class="n">sum</span><span class="o">.</span><span class="n">send</span> <span class="n">fun</span><span class="o">.</span><span class="n">to_sym</span><span class="p">,</span> <span class="n">i</span><span class="p">}</span> <span class="k">if</span> <span class="n">val</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="n">reduce</span> <span class="ss">:+</span><span class="p">,</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">)</span> <span class="c1">#=&gt; 6</span>
</span><span class='line'><span class="p">(</span><span class="n">reduce</span> <span class="ss">:+</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">)</span> <span class="c1">#=&gt; 9</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1"># piping a single input through a bunch of functions</span>
</span><span class='line'><span class="c1"># (yay, composable functions!)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">pipe</span> <span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="nb">methods</span>
</span><span class='line'> <span class="nb">methods</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="o">|</span> <span class="nb">send</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>  <span class="n">data</span><span class="o">[</span><span class="ss">:a</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>  <span class="n">data</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>  <span class="n">data</span><span class="o">[</span><span class="ss">:b</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">10</span>
</span><span class='line'>  <span class="n">data</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">}</span>
</span><span class='line'><span class="p">(</span><span class="n">pipe</span> <span class="nb">hash</span><span class="p">,</span> <span class="ss">:foo</span><span class="p">,</span> <span class="ss">:bar</span><span class="p">)</span> <span class="c1">#=&gt; {:a=&gt;1, :b=&gt;10}</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># good old filter is also pretty easy to define</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">filter</span> <span class="n">pred</span><span class="p">,</span> <span class="n">coll</span>
</span><span class='line'>  <span class="n">coll</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">select</span> <span class="o">&amp;</span><span class="n">pred</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="n">filter</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="n">x</span><span class="o">.</span><span class="n">even?</span><span class="p">},</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">)</span> <span class="o">==</span> <span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="c1">#=&gt; true</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># a function to call a lambda (forcing it to execute)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">call</span> <span class="n">b</span><span class="p">;</span> <span class="n">b</span><span class="o">.</span><span class="n">call</span><span class="p">;</span> <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">saved</span> <span class="o">=</span> <span class="nb">lambda</span> <span class="p">{</span><span class="nb">puts</span> <span class="s2">&quot;did I get called?&quot;</span><span class="p">}</span>
</span><span class='line'><span class="c1">#=&gt; #&lt;Proc:blahblahblah (lambda)&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="n">call</span> <span class="p">(</span><span class="nb">lambda</span> <span class="p">{</span><span class="nb">puts</span> <span class="s2">&quot;I got called!&quot;</span><span class="p">;</span> <span class="n">reduce</span> <span class="ss">:+</span><span class="p">,</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">}))</span>
</span><span class='line'><span class="c1">#=&gt; output: I got called!\n =&gt; 6</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/19/piping-arguments-through-multiple-functions-in-ruby/">Piping Arguments Through Multiple Functions in Ruby</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-19T16:25:00-05:00" pubdate data-updated="true">Sep 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After asking <code>#ruby</code> what the equivalent of Clojure&#8217;s <a href="http://clojuredocs.org/clojure_core/clojure.core/-%3E">-> macro</a> could look like, I compiled the collective solution into a gist. You might find this useful somewhere, especially when you have multiple transformation functions operating on the same basic data structures.</p>

<div><script src='https://gist.github.com/3752271.js?file=piping_example.rb'></script>
<noscript><pre><code># piping example in Ruby

def foo(data)
  data[:a] += 1
  data
end

def bar(data)
  data[:b] += 10
  data
end

def pipe args, *methods
 methods.reduce(args) { |a, m| send(m, a) }
end

hash = {:a =&gt; 0, :b =&gt; 0}
pipe hash, :foo, :bar
#=&gt; {:a=&gt;1, :b=&gt;10}</code></pre></noscript></div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/14/moving-from-posterous-to-github-pages/">Moving From Posterous to Github Pages</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-14T02:27:00-05:00" pubdate data-updated="true">Sep 14<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ever since Posterous was acquired by Twitter, I&#8217;d been meaning to ditch the service for something better. While it was convenient to post by email and enjoyable to forget about hosting, I missed controlling the structure of my raw posts and the site&#8217;s design.</p>

<p>So when I discovered <a href="http://octopress.org">Octopress</a>, I was quickly won over. Finally, a hacker&#8217;s workflow: compose post in Markdown, generate static content, push content to Github Pages. And since all posts are in Markdown, you truly have portable, human-readable content!</p>

<p>Once I had a repository on Github setup with my Octopress-powered blog, I needed to import posts from Posterous. Unfortunately, it wasn&#8217;t a straightforward process, but I decided to automate away the drudgery and share some code with you in the process.</p>

<p>After consulting <a href="http://posterous.com/api">Posterous&#8217;s API</a>, I realized I only really needed my &#8220;site_id&#8221; to pull all my posts in a single JSON request. The following URLs were helpful for this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># http://posterous.com/api/2/users/me =&gt; authenticated user&#39;s info, including ID</span>
</span><span class='line'><span class="c1"># http://posterous.com/api/2/sites?id=1021298 =&gt; sites of user; figure out site_id</span>
</span><span class='line'><span class="c1"># http://posterous.com/api/2/sites/2464344/posts =&gt; all of kilotau&#39;s posts in JSON; using site_id</span>
</span></code></pre></td></tr></table></div></figure>


<p>After I had my posts downloaded in <code>posts.json</code>, I transformed each post to Markdown and manually formatted them for Octopress. I used the simple <a href="https://github.com/singpolyma/HTML2Markdown">HTML2Markdown</a> script and the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># this uses ruby-1.9.3</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;fileutils&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;./html2markdown.rb&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;date&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">json</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;./posts.json&#39;</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="n">json</span><span class="o">.</span><span class="n">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">j</span><span class="o">|</span>
</span><span class='line'>  <span class="n">d</span> <span class="o">=</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">j</span><span class="o">[</span><span class="s1">&#39;display_date&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;./md/&quot;</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-%d&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">j</span><span class="o">[</span><span class="s1">&#39;slug&#39;</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot;.markdown&quot;</span>
</span><span class='line'>  <span class="n">file</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;---</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;layout: post</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;title: &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">j</span><span class="o">[</span><span class="s1">&#39;title&#39;</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;date: &quot;</span> <span class="o">+</span> <span class="n">j</span><span class="o">[</span><span class="s1">&#39;display_date&#39;</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;comments: false</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;external-url:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;categories:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;---</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">write</span> <span class="no">HTML2Markdown</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">j</span><span class="o">[</span><span class="s1">&#39;body_cleaned&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="n">file</span><span class="o">.</span><span class="n">close</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>In a moment, I had all my posts converted.</p>

<p>Now that I have my past posts, it&#8217;s time to play with the design!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/07/06/creating-a-simple-sentiment-analyzer-using-cl/">Sentimental: A Simple Sentiment Analyzer in Clojure</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-07-06T19:49:00-05:00" pubdate data-updated="true">Jul 6<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>TL;DR <a href="https://github.com/gnarmis/sentimental">https://github.com/gnarmis/sentimental</a></p>

<p>Sentiment analysis is the hot thing to do these days. One example is ViralHeat,
a social media monitoring platform that uses sentiment analysis to provide
a picture about how the conversation is trending about certain keywords (or
combinations of keywords, which they call profiles). There&#8217;s a lot of such
products, and for developers there&#8217;s a lot of high-quality and extensive libraries
and toolkits that provide for this among other solutions, such Java&#8217;s WEKA
or OpenNLP, or Python&#8217;s NLTK. There&#8217;s even many third-party solutions that
provide an API you can use to get sentiment analysis, such as AlchemyAPI.</p>

<p>After deciding to create my very own sentiment analysis tool using Clojure,
I began researching libraries in both Java and Clojure (because Clojure&#8217;s interop
means that I can easily use Java libraries). There&#8217;s a lot of powerful tools
out there, but my goal was to find something simple that could allow me to
make a good enough sentiment analyzer without breaking the technical bank,
so to speak.</p>

<p>At first, I was looking for facilities to stem words, for which someone had
already provided a Clojure-wrapper around the Java library Snowball. <a href="http://kilotau.com/a-brief-foray-into-deploying-clojure-librarie">I forked
this and deployed it to Clojars</a>. This, and a simple list of stop words
to ignore, would allow me to reduce redundancies and get a &#8220;bag of words&#8221; representation
of the target document.</p>

<p>Next, I wanted a nice and simple NLP library. <a href="https://github.com/dakrone/clojure-opennlp">Clojure-OpenNLP</a> fit the
bill perfectly. It even had a document categorizer I could train!</p>

<p>Now, I should briefly explain the overall process. At the heart of the sentiment
analyzer is a naive-Bayesian classifier. This classifier is provided with a
labelled list as training material (&#8220;sad&#8221; is &#8220;negative&#8221;, &#8220;happy&#8221; is &#8220;positive&#8221;).
The various categories are the sentiments, such as &#8220;positive&#8221;, &#8220;negative&#8221;,
&#8220;neutral&#8221; (I used 6 categories, for strong/weak sentiment). The classifier
then learns to associate categories with words, based on training information
that is supplied to it. Given a new sentence, the classifier then calculates
the probabilities of each word belonging to each category, and the category
with the best probability of covering the sentence is returned. Learn more
about how to build naive-Bayes classifiers <a href="http://bionicspirit.com/blog/2012/02/09/howto-build-naive-bayes-classifier.html">here</a>.</p>

<p>So, the next step was to get the actual training data. I found the <a href="http://www.cs.pitt.edu/mpqa/">subjectivity
lexicon</a> to fit my needs perfectly. After parsing the document into a vector
of hash-maps, I was able to create a <a href="https://github.com/gnarmis/sentimental/blob/master/src/models/sentiment.train">training document</a> for my very own
opennlp model, which was to be the classifier. The other step was to create
a function that would remove stop words and also stem each word. This was pretty
easy to do using the <a href="https://github.com/gnarmis/snowball-stemmer">snowball-stemmer</a> library and a few lines of Clojure.</p>

<p>Granted, I didn&#8217;t build my own naive-Bayes classifier, but that&#8217;s a project
for another time :)</p>

<p>And here&#8217;s the project: https://github.com/gnarmis/sentimental</p>

<p>You do need to install Leiningen and have JDK 1.6 on your machine. After these
two steps, simply <code>cd</code> into the project and type <code>lein repl</code>, following the
example in the readme.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h2><i>a blog about the joys of programming</i></h2>
</section><section>
  <h1>About Me</h1>
  <p>Hi, I&#8217;m Gursimran Singh (<a href="http://twitter.com/gnarmis">@gnarmis</a>). I&#8217;m a Northwestern student, programmer, and sci-fi fan, and I have an interest in startup culture.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/01/11/colby-small-wrapper-and-functions-for-persistent/">Colby: Small Wrapper and Functions for Persistent, Immutable Data Structures</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/05/project-euler-problem-3-using-clojure-1-dot-5-and-a-lazy-technique/">Project Euler Problem 3 using Clojure 1.5 and a lazy technique</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/18/repomap-track-your-local-git-repositories/">RepoMap: track your local git repositories</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/08/twitter-spam-machine-learning/">Ready Spam Detection in Twitter - Extended Abstract</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/18/hack-northwestern-updates/">Hack Northwestern updates</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Category Cloud</h1>
  <span id="tag-cloud"><a href='/blog/categories/bash' style='font-size: 104.0%'>bash(1)</a> <a href='/blog/categories/clojure' style='font-size: 128.0%'>clojure(7)</a> <a href='/blog/categories/coffeescript' style='font-size: 104.0%'>coffeescript(1)</a> <a href='/blog/categories/devops' style='font-size: 108.0%'>devops(2)</a> <a href='/blog/categories/euler' style='font-size: 108.0%'>euler(2)</a> <a href='/blog/categories/hackathon' style='font-size: 104.0%'>hackathon(1)</a> <a href='/blog/categories/hacknu' style='font-size: 108.0%'>hacknu(2)</a> <a href='/blog/categories/html5' style='font-size: 104.0%'>html5(1)</a> <a href='/blog/categories/javascript' style='font-size: 104.0%'>javascript(1)</a> <a href='/blog/categories/mobile' style='font-size: 104.0%'>mobile(1)</a> <a href='/blog/categories/productivity' style='font-size: 104.0%'>productivity(1)</a> <a href='/blog/categories/projects' style='font-size: 160.0%'>projects(15)</a> <a href='/blog/categories/quotes' style='font-size: 104.0%'>quotes(1)</a> <a href='/blog/categories/ruby' style='font-size: 140.0%'>ruby(10)</a> <a href='/blog/categories/sass' style='font-size: 104.0%'>sass(1)</a> <a href='/blog/categories/snippets' style='font-size: 108.0%'>snippets(2)</a> <a href='/blog/categories/talks' style='font-size: 104.0%'>talks(1)</a> <a href='/blog/categories/updates' style='font-size: 108.0%'>updates(2)</a> <a href='/blog/categories/webdev' style='font-size: 128.0%'>webdev(7)</a> </span>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("gnarmis", 10, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/gnarmis" class="twitter-follow-button" data-show-count="false">Follow @gnarmis</a>
  
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo" style="margin-bottom:0;"><p>
  Copyright &copy; 2013 - Gursimran Singh -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'kilotau';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
